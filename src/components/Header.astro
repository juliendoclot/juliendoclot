---
import { SITE_TITLE } from '../consts';
import ThemeToggle from './ThemeToggle.astro';
import logoLight from '../assets/logo.webp';
import logoDark from '../assets/logo-dark.webp';

const currentPath = Astro.url.pathname;
---

<header class="sticky top-4 z-50 mx-4 sm:mx-6 lg:mx-auto lg:max-w-5xl">
	<nav class="bg-white dark:bg-[#0f0f1a] border border-gray-200 dark:border-gray-800 rounded-full px-4 sm:px-6 shadow-sm transition-colors duration-300">
		<div class="flex items-center justify-between h-14">
			<!-- Logo -->
			<a href="/" class="flex items-center no-underline">
				<img src={logoLight.src} alt="Julien Doclot" class="h-8 dark:hidden" />
				<img src={logoDark.src} alt="Julien Doclot" class="h-8 hidden dark:block" />
			</a>

			<!-- Center Navigation -->
			<div class="hidden md:flex items-center gap-1">
				<a
					href="/"
					class:list={[
						"px-4 py-1.5 text-sm font-medium rounded-full transition-colors no-underline",
						currentPath === "/"
							? "text-gray-900 dark:text-white"
							: "text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"
					]}
				>
					Accueil
				</a>

				<a
					href="/blog"
					class:list={[
						"px-4 py-1.5 text-sm font-medium rounded-full transition-colors no-underline",
						currentPath.startsWith("/blog")
							? "text-gray-900 dark:text-white"
							: "text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"
					]}
				>
					Blog
				</a>

				<a
					href="/contact"
					class:list={[
						"px-4 py-1.5 text-sm font-medium rounded-full transition-colors no-underline",
						currentPath === "/contact"
							? "text-gray-900 dark:text-white"
							: "text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"
					]}
				>
					Contact
				</a>
			</div>

			<!-- Right side -->
			<div class="flex items-center gap-2">
				<!-- Theme Toggle -->
				<ThemeToggle />


				<!-- Mobile menu button -->
				<button
					id="mobile-menu-button"
					class="md:hidden p-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded-full"
					aria-label="Menu"
					aria-expanded="false"
				>
					<svg class="w-5 h-5 menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
					</svg>
					<svg class="w-5 h-5 close-icon hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
					</svg>
				</button>
			</div>
		</div>
	</nav>

	<!-- Mobile menu -->
	<div id="mobile-menu" class="md:hidden hidden mt-2">
		<div class="bg-white dark:bg-[#0f0f1a] border border-gray-200 dark:border-gray-800 rounded-2xl px-4 py-3 shadow-lg">
			<a
				href="/"
				class:list={[
					"block px-4 py-2.5 text-sm font-medium rounded-xl transition-colors no-underline",
					currentPath === "/"
						? "text-gray-900 dark:text-white bg-gray-100 dark:bg-gray-800"
						: "text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800/50"
				]}
			>
				Accueil
			</a>

			<a
				href="/blog"
				class:list={[
					"block px-4 py-2.5 text-sm font-medium rounded-xl transition-colors no-underline",
					currentPath.startsWith("/blog")
						? "text-gray-900 dark:text-white bg-gray-100 dark:bg-gray-800"
						: "text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800/50"
				]}
			>
				Blog
			</a>

			<a
				href="/contact"
				class:list={[
					"block px-4 py-2.5 text-sm font-medium rounded-xl transition-colors no-underline",
					currentPath === "/contact"
						? "text-gray-900 dark:text-white bg-gray-100 dark:bg-gray-800"
						: "text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-800/50"
				]}
			>
				Contact
			</a>
		</div>
	</div>
</header>

<script>
	const menuButton = document.getElementById('mobile-menu-button');
	const mobileMenu = document.getElementById('mobile-menu');
	const menuIcon = menuButton?.querySelector('.menu-icon');
	const closeIcon = menuButton?.querySelector('.close-icon');

	menuButton?.addEventListener('click', () => {
		const isOpen = mobileMenu?.classList.contains('hidden');

		if (isOpen) {
			mobileMenu?.classList.remove('hidden');
			menuIcon?.classList.add('hidden');
			closeIcon?.classList.remove('hidden');
			menuButton.setAttribute('aria-expanded', 'true');
		} else {
			mobileMenu?.classList.add('hidden');
			menuIcon?.classList.remove('hidden');
			closeIcon?.classList.add('hidden');
			menuButton.setAttribute('aria-expanded', 'false');
		}
	});

	// Close menu when clicking outside
	document.addEventListener('click', (e) => {
		if (!menuButton?.contains(e.target as Node) && !mobileMenu?.contains(e.target as Node)) {
			mobileMenu?.classList.add('hidden');
			menuIcon?.classList.remove('hidden');
			closeIcon?.classList.add('hidden');
			menuButton?.setAttribute('aria-expanded', 'false');
		}
	});
</script>
