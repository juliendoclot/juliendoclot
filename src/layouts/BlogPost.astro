---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import Layout from './Layout.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { formatReadingTime } from '../utils/readingTime';

type Props = CollectionEntry<'blog'>['data'] & { readingTime?: number };

const { title, description, pubDate, updatedDate, heroImage, tags, readingTime } = Astro.props;
---

<Layout title={title} description={description} image={heroImage}>
	<article class="py-8">
		<!-- Article Header -->
		<header class="mb-8 text-center">
			<!-- Date & Reading Time -->
			<div class="flex items-center justify-center gap-2 text-sm text-gray-500 dark:text-gray-400 mb-4">
				<FormattedDate date={pubDate} />
				{readingTime && (
					<>
						<span>•</span>
						<span>{formatReadingTime(readingTime)}</span>
					</>
				)}
				{updatedDate && (
					<>
						<span>•</span>
						<span class="italic">
							Mis à jour le <FormattedDate date={updatedDate} />
						</span>
					</>
				)}
			</div>

			<!-- Title -->
			<h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-6 leading-tight">
				{title}
			</h1>

			<!-- Tags -->
			{tags && tags.length > 0 && (
				<div class="flex flex-wrap justify-center gap-2">
					{tags.map((tag) => (
						<span class="px-3 py-1 text-sm font-medium rounded-full bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300">
							{tag}
						</span>
					))}
				</div>
			)}
		</header>

		<!-- Hero Image -->
		{heroImage && (
			<div class="relative mb-8 -mx-4 sm:mx-0 overflow-hidden rounded-none sm:rounded-2xl">
				<Image
					src={heroImage}
					alt={title}
					width={1200}
					height={600}
					class="w-full aspect-video object-cover"
				/>
			</div>
		)}

		<!-- Article Content -->
		<div class="prose prose-lg max-w-4xl mx-auto">
			<slot />
		</div>

	</article>
</Layout>
